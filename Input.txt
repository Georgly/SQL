select A.d, gd, Ba.*, *
from Ba, (select * from D where d<gd)
where bad < (select dady from A)
group by a, b
having gd > 1000
order by b;
